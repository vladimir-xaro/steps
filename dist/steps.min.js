var Steps=function(){"use strict";var t=function(){return(t=Object.assign||function(t){for(var i,e=1,s=arguments.length;e<s;e++)for(var r in i=arguments[e])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)};class i{constructor(t={}){this.events={};for(let i in t)t[i]&&this.subscribe(i,t[i])}subscribe(t,i){this.has(t)||(this.events[t]=[]);let e=[];if(Array.isArray(i))for(const s of i)e.push(...this.subscribe(t,s));else this.events[t].push(i),e.push((()=>this.removeListener(t,i)));return e}unsubscribe(...t){for(const i of t)this.events[i]&&delete this.events[i]}removeListener(t,i){if(Array.isArray(this.events[t])){const e=this.events[t].indexOf(i);e>-1&&this.events[t].splice(e,1)}}once(t,i){const e=this.subscribe(t,(()=>{e[0](),Array.isArray(i)?i.forEach((t=>t())):i()}))}has(t){return!!this.events[t]}listenerCount(t){return!!this.events.hasOwnProperty(t)&&this.events[t].length}emit(t,...i){const e=this.events[t];if(e)for(let t of e)t(...i)}validateEmit(t,...i){const e=this.events[t];if(!e)return!1;for(const t of e)if(!t(...i))return!1;return!0}seriesEmit(t,...i){const e=this.events[t];if(!e)return;let s;for(let t=0;t<e.length;t++)s=0===t?e[t](...i):e[t](s);return s}}var e={prev:{visibleIf:function(t){return t.current>0},on:{click:function(t){},lock:function(t){},unlock:function(t){}}},next:{visibleIf:function(t){return t.current<t.last-1},on:{click:function(t){},lock:function(t){},unlock:function(t){}}}},s=function(){function t(t){this.steps=t.steps,this.emitter=new i(t.on),this.key=t.key,this.isLock=!!t.hasOwnProperty("isLock")&&t.isLock,this.isVisible=!t.hasOwnProperty("isVisible")||t.isVisible,this.validators={visibleIf:t.visibleIf||e[this.key].visibleIf},t.el&&(this.el=t.el,this.el.addEventListener("click",this.click.bind(this))),this.emitter.emit("init",this)}return t.prototype.click=function(){this.isLock||this.emitter.emit("click",this)},t.prototype.hide=function(){this.isVisible&&this.el instanceof HTMLElement&&(this.emitter.emit("beforeHide",this),this.isVisible=!1,this.el.classList.add("hidden"),this.emitter.emit("afterHide",this))},t.prototype.show=function(){!this.isVisible&&this.el instanceof HTMLElement&&(this.emitter.emit("beforeShow",this),this.isVisible=!0,this.el.classList.remove("hidden"),this.emitter.emit("afterShow",this))},t.prototype.lock=function(){this.isLock||(this.emitter.emit("beforeLock",this),this.isLock=!0,this.emitter.emit("afterLock",this))},t.prototype.unlock=function(){this.isLock&&(this.emitter.emit("beforeUnlock",this),this.isLock=!1,this.emitter.emit("afterUnlock",this))},t}(),r=function(){function t(t){this.steps=t.steps,this.emitter=new i(t.on),t.el&&(this.el=t.el,this.lineEl=this.el.querySelector(".progress-line")),this.emitter.emit("init",this)}return Object.defineProperty(t.prototype,"width",{get:function(){return this.steps.current/this.steps.last*100},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.lineEl&&(console.log("progress"),this.lineEl.style.width=this.width+"%")},t}(),n=function(){function t(t){this.steps=t.steps,this.emitter=new i(t.on),this.isVisible=!1,this.isFinal=!!t.hasOwnProperty("isFinal")&&t.isFinal,t.el&&(this.el=t.el),this.emitter.emit("init",this)}return Object.defineProperty(t.prototype,"visible",{get:function(){return this.isVisible},set:function(t){this.el&&this.el.classList[t?"add":"remove"]("visible"),this.isVisible=t},enumerable:!1,configurable:!0}),t.prototype.hide=function(){this.emitter.emit("beforeHide",this),this.visible=!1,this.emitter.emit("afterHide",this)},t.prototype.show=function(){this.emitter.emit("beforeShow",this),this.visible=!0,this.emitter.emit("afterShow",this)},t}();return function(){function o(o){if(this.items=[],this.controls={},this.current=0,!o)throw new Error("Config is not exists");if(this.emitter=new i(o.on),o.el&&(this.el=o.el),o.items&&o.items instanceof Object)for(var h=0,c=o.items;h<c.length;h++){var l=c[h],u=new n(t({steps:this},l));this.items.push(u)}if(this.current=0,o.controls)if(Array.isArray(o.controls));else if(o.controls instanceof Object){for(var f in o.controls)if(e.hasOwnProperty(f)){var p=new s(t({steps:this,key:f},o.controls[f]));p.emitter.subscribe("click",this[f].bind(this)),this.controls[f]=p}this.fixVisibility()}o.progress&&(this.progress=new r(t({steps:this},o.progress)),this.progress.update()),this.emitter.emit("init",this)}return Object.defineProperty(o.prototype,"last",{get:function(){return this.items.length-1},enumerable:!1,configurable:!0}),o.prototype.prev=function(){this.current<1||(this.items[this.current].hide(),this.current--,this.fixVisibility(),this.progress&&this.progress.update(),this.items[this.current].show(),console.log("Steps::prev(), current index = "+this.current))},o.prototype.next=function(){this.current>=this.last?console.log("Steps::next() ======>"):(this.items[this.current].hide(),this.current++,this.fixVisibility(),this.progress&&this.progress.update(),this.items[this.current].show(),console.log("Steps::next(), current index = "+this.current))},o.prototype.fixVisibility=function(){if(this.controls)for(var t in this.controls){var i=this.controls[t];i.validators.visibleIf(this)?!i.isVisible&&i.show():i.isVisible&&i.hide()}},o.prototype.destroy=function(){},o}()}();
//# sourceMappingURL=steps.min.js.map
